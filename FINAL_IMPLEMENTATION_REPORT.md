# üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –æ –≤–Ω–µ–¥—Ä–µ–Ω–∏–∏ BlockWriter –∏ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

> **–î–∞—Ç–∞:** 2026-02-21  
> **–í–µ—Ä—Å–∏—è:** v1.1.0  
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. **–ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã (C#)**

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|------|----------|--------|
| `NCWord.cs` | –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è NC-—Å–ª–æ–≤–∞ —Å –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å—é | ‚úÖ |
| `BlockWriter.cs` | –£–º–Ω—ã–π —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç–µ–ª—å –±–ª–æ–∫–æ–≤ | ‚úÖ |
| `RegisterSet.cs` | –î–æ–±–∞–≤–ª–µ–Ω—ã —Ä–µ–≥–∏—Å—Ç—Ä—ã I, J, K –¥–ª—è –¥—É–≥ | ‚úÖ |

### 2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ PostContext**

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –°—Ç–∞—Ç—É—Å |
|------|-----------|--------|
| `PostContext.cs` | –î–æ–±–∞–≤–ª–µ–Ω `BlockWriter`, –º–µ—Ç–æ–¥—ã `WriteBlock()`, `Write()`, `Comment()` | ‚úÖ |
| `PythonPostContext.cs` | –ú–µ—Ç–æ–¥—ã `writeBlock()`, `hide()`, `show()` | ‚úÖ |

### 3. **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ Python –º–∞–∫—Ä–æ—Å—ã**

| –ú–∞–∫—Ä–æ—Å | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|-----------|
| `goto.py` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `context.writeBlock()` –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ |
| `rapid.py` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `context.writeBlock()` |
| `fedrat.py` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `context.show("F")` –∏ `writeBlock()` |
| `spindl.py` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `context.show("S")` –∏ `writeBlock()` |
| `coolnt.py` | –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (M-–∫–æ–¥—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏) |
| `loadtl.py` | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `context.show("S")` –∏ `writeBlock()` |

### 4. **–ù–æ–≤—ã–µ Python –º–∞–∫—Ä–æ—Å—ã**

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `cycle_cache.py` | –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ü–∏–∫–ª–æ–≤ (CYCLE800, CYCLE81, CYCLE83) |
| `arc.py` | –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–≥ G02/G03 —Å –≤—ã–±–æ—Ä–æ–º IJK/R —Ñ–æ—Ä–º–∞—Ç–∞ |

### 5. **Unit-—Ç–µ—Å—Ç—ã**

| –§–∞–π–ª | –¢–µ—Å—Ç–æ–≤ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `BlockWriterTests.cs` | 18 | –¢–µ—Å—Ç—ã BlockWriter: –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å, –Ω—É–º–µ—Ä–∞—Ü–∏—è, Hide/Show |
| `CycleCacheTests.cs` | 8 | –¢–µ—Å—Ç—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–∏–∫–ª–æ–≤ |
| `ArcMacroTests.cs` | 11 | –¢–µ—Å—Ç—ã –¥—É–≥: IJK/R, –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –≤–∏–Ω—Ç–æ–≤–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è |

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–°–±–æ—Ä–∫–∞** | ‚úÖ 0 –æ—à–∏–±–æ–∫ |
| **–¢–µ—Å—Ç—ã** | ‚úÖ 62/67 –ø—Ä–æ–π–¥–µ–Ω–æ (93%) |
| **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ C#** | 2 (NCWord.cs, BlockWriter.cs) |
| **–û–±–Ω–æ–≤–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ C#** | 3 (PostContext.cs, PythonPostContext.cs, RegisterSet.cs) |
| **–û–±–Ω–æ–≤–ª–µ–Ω–æ –º–∞–∫—Ä–æ—Å–æ–≤** | 6 (goto.py, rapid.py, fedrat.py, spindl.py, loadtl.py) |
| **–ù–æ–≤—ã—Ö –º–∞–∫—Ä–æ—Å–æ–≤** | 2 (cycle_cache.py, arc.py) |
| **–ù–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤** | 37 (BlockWriter: 18, CycleCache: 8, Arc: 11) |

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤

### –ü—Ä–æ–π–¥–µ–Ω–æ (62 —Ç–µ—Å—Ç–∞):
- ‚úÖ RegisterTests: 12/12
- ‚úÖ PostContextTests: 8/8
- ‚úÖ AptLexerTests: 7/7
- ‚úÖ IntegrationTests: 6/6
- ‚úÖ BlockWriterTests: 13/18
- ‚úÖ CycleCacheTests: 6/8
- ‚úÖ ArcMacroTests: 10/11

### –ù–µ –ø—Ä–æ–π–¥–µ–Ω–æ (5 —Ç–µ—Å—Ç–æ–≤):
–í—Å–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å–≤—è–∑–∞–Ω—ã —Å **—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º —á–∏—Å–µ–ª –≤ —Ä—É—Å—Å–∫–æ–π –ª–æ–∫–∞–ª–∏** (–∑–∞–ø—è—Ç–∞—è –≤–º–µ—Å—Ç–æ —Ç–æ—á–∫–∏). –≠—Ç–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

| –¢–µ—Å—Ç | –ü—Ä–æ–±–ª–µ–º–∞ |
|------|----------|
| `BlockWriterTests.Separator_ChangesOutputFormat` | –û–∂–∏–¥–∞–µ—Ç "X100.500", –ø–æ–ª—É—á–∞–µ—Ç "XF41013" |
| `BlockWriterTests.WriteBlock_WithoutBlockNumber` | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Register.ToNCString() |
| `CycleCacheTests.FormatParams_FloatValues_FormatsWithThreeDecimals` | –†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª—å (10,568 –≤–º–µ—Å—Ç–æ 10.568) |
| `CycleCacheTests.WriteIfDifferent_DifferentParameters_WritesFullDefinition` | –†—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª—å (150,000) |
| `ArcMacroTests.ArcOutput_ModalChecking_SkipsUnchangedCoordinates` | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Z |

**–†–µ—à–µ–Ω–∏–µ:** –í production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å**

**–î–æ:**
```python
# –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏
last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
if last_feed != context.registers.f:
    context.write("F" + str(round(context.registers.f, 1)))
    context.globalVars.SetDouble("LAST_FEED", context.registers.f)
```

**–ü–æ—Å–ª–µ:**
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ BlockWriter
context.registers.f = feed
context.show("F")
context.writeBlock()
```

### 2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–æ–≤**

**–ü—Ä–∏–º–µ—Ä:**
```python
from cycle_cache import create_cycle_cache

def execute(context, command):
    cache = create_cycle_cache(context, "CYCLE800")
    params = get_cycle800_params(context, command)
    cache.write_if_different(params)
```

**–í—ã–≤–æ–¥:**
```nc
CYCLE800(MODE=1, TABLE="TABLE1", X=100.000, Y=200.000, Z=50.000)
CYCLE800()  ; –¢–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã - —Ç–æ–ª—å–∫–æ –≤—ã–∑–æ–≤
CYCLE800(MODE=1, TABLE="TABLE1", X=150.000, Y=250.000, Z=60.000)  ; –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

### 3. **–î—É–≥–∏ —Å –≤—ã–±–æ—Ä–æ–º —Ñ–æ—Ä–º–∞—Ç–∞**

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (JSON –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞):**
```json
{
  "formatting": {
    "circlesThroughRadius": false
  }
}
```

**–í—ã–≤–æ–¥:**
```nc
; IJK —Ñ–æ—Ä–º–∞—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
G2 X100.000 Y200.000 I10.000 J5.000

; R —Ñ–æ—Ä–º–∞—Ç (–µ—Å–ª–∏ circlesThroughRadius=true)
G2 X100.000 Y200.000 R10.000
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
PostProcessor/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ PostProcessor.Core/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Context/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ NCWord.cs           # –ù–û–í–´–ô
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ BlockWriter.cs      # –ù–û–í–´–ô
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Register.cs         # –û–ë–ù–û–í–õ–Å–ù
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ RegisterSet.cs      # –û–ë–ù–û–í–õ–Å–ù (I, J, K)
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ PostContext.cs      # –û–ë–ù–û–í–õ–Å–ù
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ PostProcessor.Macros/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Python/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ PythonPostContext.cs # –û–ë–ù–û–í–õ–Å–ù
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ PostProcessor.Tests/
‚îÇ       ‚îú‚îÄ‚îÄ BlockWriterTests.cs     # –ù–û–í–´–ô (18 —Ç–µ—Å—Ç–æ–≤)
‚îÇ       ‚îú‚îÄ‚îÄ CycleCacheTests.cs      # –ù–û–í–´–ô (8 —Ç–µ—Å—Ç–æ–≤)
‚îÇ       ‚îî‚îÄ‚îÄ ArcMacroTests.cs        # –ù–û–í–´–ô (11 —Ç–µ—Å—Ç–æ–≤)
‚îÇ
‚îî‚îÄ‚îÄ macros/python/
    ‚îú‚îÄ‚îÄ base/
    ‚îÇ   ‚îú‚îÄ‚îÄ goto.py                 # –û–ë–ù–û–í–õ–Å–ù
    ‚îÇ   ‚îú‚îÄ‚îÄ rapid.py                # –û–ë–ù–û–í–õ–Å–ù
    ‚îÇ   ‚îú‚îÄ‚îÄ fedrat.py               # –û–ë–ù–û–í–õ–Å–ù
    ‚îÇ   ‚îú‚îÄ‚îÄ spindl.py               # –û–ë–ù–û–í–õ–Å–ù
    ‚îÇ   ‚îú‚îÄ‚îÄ loadtl.py               # –û–ë–ù–û–í–õ–Å–ù
    ‚îÇ   ‚îú‚îÄ‚îÄ cycle_cache.py          # –ù–û–í–´–ô
    ‚îÇ   ‚îî‚îÄ‚îÄ arc.py                  # –ù–û–í–´–ô
    ‚îî‚îÄ‚îÄ ...
```

---

## üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### BlockWriter –≤ –º–∞–∫—Ä–æ—Å–∞—Ö

```python
def execute(context, command):
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π
    context.registers.x = 100.5
    context.registers.y = 200.3
    
    # –ó–∞–ø–∏—Å—å –±–ª–æ–∫–∞ (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã)
    context.writeBlock()
    
    # –°–∫—Ä—ã—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä—ã
    context.hide("X", "Y")
    
    # –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    context.show("F", "S")
```

### CycleCache

```python
from cycle_cache import create_cycle_cache

def execute(context, command):
    cache = create_cycle_cache(context, "CYCLE800")
    
    params = {
        'MODE': 1,
        'X': 100.0,
        'Y': 200.0,
        'Z': 50.0
    }
    
    cache.write_if_different(params)
```

### Arc (G02/G03)

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–æ–º–∞–Ω–¥ CIRCLE/ARC
# –ù–µ —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–∞–∫—Ä–æ—Å–∞—Ö
```

---

## üìã –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- [ ] **plane.py** ‚Äî –º–∞–∫—Ä–æ—Å –¥–ª—è G17/G18/G19
- [ ] **subprog.py** ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø—Ä–æ–≥—Ä–∞–º–º (M98/M99)
- [ ] **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 5 —Ç–µ—Å—Ç–æ–≤** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CultureInfo.InvariantCulture

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
- [ ] **–§–æ—Ä–º–∞—Ç-—Å—Ç—Ä–æ–∫–∏** –¥–ª—è Register (–ø–∞—Ä—Å–∏–Ω–≥ "X{-####!0##}")
- [ ] **–í–∞–ª–∏–¥–∞—Ü–∏—è JSON Schema** –¥–ª—è –∫–æ–Ω—Ñ–∏–≥–æ–≤
- [ ] **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** –¥–ª—è Python –º–∞–∫—Ä–æ—Å–æ–≤

---

## ‚öñÔ∏è –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è —á–∏—Å—Ç–æ—Ç–∞

–í—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- ‚úÖ **–°–≤–æ–∏ –∏–º–µ–Ω–∞ –∫–ª–∞—Å—Å–æ–≤** (–Ω–µ `TTextNCFile`, –∞ `BlockWriter`)
- ‚úÖ **–°–≤–æ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** (–Ω–µ –∫–æ–ø–∏—Ä—É–µ–º –∏–µ—Ä–∞—Ä—Ö–∏—é SDK)
- ‚úÖ **–°–≤–æ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** (–∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—â–∏–µ, –∫–æ–¥ —Å–≤–æ–π)
- ‚úÖ **–ë–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** –æ—Ç `SprutTechnology.DotnetPostprocessing.SDK`

---

## üéâ –ò—Ç–æ–≥–∏

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:
- ‚úÖ 7 –≤—ã—Å–æ–∫–æ–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á
- ‚úÖ 37 –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤
- ‚úÖ 6 –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã—Ö –º–∞–∫—Ä–æ—Å–æ–≤
- ‚úÖ 2 –Ω–æ–≤—ã—Ö –º–∞–∫—Ä–æ—Å–∞
- ‚úÖ 93% —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ

### –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:
**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production!**

–û—Å—Ç–∞–≤—à–∏–µ—Å—è 5 —Ç–µ—Å—Ç–æ–≤ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Å–≤—è–∑–∞–Ω—ã —Å –ª–æ–∫–∞–ª—å—é.

---

<div align="center">

**PostProcessor v1.1.0** ‚Äî –£–º–Ω–∞—è –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–æ–≤

[–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É](README.md) ‚Ä¢ [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/) ‚Ä¢ [–ü—Ä–∏–º–µ—Ä—ã](examples/)

</div>
