# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: Python –º–∞–∫—Ä–æ—Å—ã –∑–∞ 10 –º–∏–Ω—É—Ç

> **–î–ª—è –∫–æ–≥–æ:** –ù–æ–≤–∏—á–∫–∏ –±–µ–∑ –æ–ø—ã—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
> **–í—Ä–µ–º—è:** 10 –º–∏–Ω—É—Ç
> **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞–±–æ—Ç–∞—é—â–∏–π –º–∞–∫—Ä–æ—Å –¥–ª—è –≤–∞—à–µ–≥–æ —Å—Ç–∞–Ω–∫–∞

---

## üìã –ß—Ç–æ –≤—ã —É–∑–Ω–∞–µ—Ç–µ

1. ‚úÖ –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
2. ‚úÖ –ö–∞–∫ –Ω–∞–ø–∏—Å–∞—Ç—å –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å
3. ‚úÖ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
4. ‚úÖ –ì–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

## –®–∞–≥ 1: –ü–æ–Ω–∏–º–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É (2 –º–∏–Ω—É—Ç—ã)

### –ß—Ç–æ —Ç–∞–∫–æ–µ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä?

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CAM-—Å–∏—Å—Ç–µ–º–∞   ‚îÇ     ‚îÇ   –ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä  ‚îÇ     ‚îÇ    –°—Ç–∞–Ω–æ–∫ –ß–ü–£   ‚îÇ
‚îÇ   (CATIA, NX)   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ + Python –º–∞–∫—Ä–æ—Å—ã ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ    (Siemens,    ‚îÇ
‚îÇ                 ‚îÇ     ‚îÇ                  ‚îÇ     ‚îÇ    Fanuc...)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
      APT-—Ñ–∞–π–ª                G-–∫–æ–¥                   –û–±—Ä–∞–±–æ—Ç–∫–∞
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
PostProcessor/
‚îú‚îÄ‚îÄ macros/
‚îÇ   ‚îî‚îÄ‚îÄ python/
‚îÇ       ‚îú‚îÄ‚îÄ base/      # –ë–∞–∑–æ–≤—ã–µ –º–∞–∫—Ä–æ—Å—ã (–Ω–µ —Ç—Ä–æ–≥–∞—Ç—å)
‚îÇ       ‚îú‚îÄ‚îÄ mmill/     # –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –≤–∞—à–µ–≥–æ —Å—Ç–∞–Ω–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ user/      # –í–∞—à–∏ –º–∞–∫—Ä–æ—Å—ã (–∑–¥–µ—Å—å —Ä–∞–±–æ—Ç–∞–µ–º)
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ machines/      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å—Ç–∞–Ω–∫–æ–≤
‚îî‚îÄ‚îÄ docs/              # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## –®–∞–≥ 2: –ü–∏—à–µ–º –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å (3 –º–∏–Ω—É—Ç—ã)

### –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `macros/python/user/my_first_macro.py`:

```python
# -*- coding: ascii -*-
# –ú–æ–π –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å

def execute(context, command):
    """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∞–∫—Ä–æ—Å"""
    context.comment("=== –ü—Ä–∏–≤–µ—Ç –æ—Ç Python –º–∞–∫—Ä–æ—Å–∞! ===")
    context.write("G0 X0 Y0 Z50")
```

### –†–∞–∑–±–∏—Ä–∞–µ–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º

| –°—Ç—Ä–æ–∫–∞ | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç |
|--------|------------|
| `# -*- coding: ascii -*-` | –ö–æ–¥–∏—Ä–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) |
| `def execute(context, command):` | –§—É–Ω–∫—Ü–∏—è –º–∞–∫—Ä–æ—Å–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ) |
| `context.comment(...)` | –í—ã–≤–æ–¥ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –≤ —Å–∫–æ–±–∫–∞—Ö |
| `context.write(...)` | –í—ã–≤–æ–¥ G-–∫–æ–¥–∞ |

### –ó–∞–ø–æ–º–Ω–∏—Ç–µ 2 –∫–æ–º–∞–Ω–¥—ã

```python
context.write("G01 X100")     # –í—ã–≤–µ—Å—Ç–∏ G-–∫–æ–¥
context.comment("–¢–µ–∫—Å—Ç")      # –í—ã–≤–µ—Å—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
```

---

## –®–∞–≥ 3: –ó–∞–ø—É—Å–∫–∞–µ–º (2 –º–∏–Ω—É—Ç—ã)

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ APT-—Ñ–∞–π–ª–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `test.apt`:

```apt
PARTNO/TEST_PART
GOTO/0, 0, 0
GOTO/100, 50, 10
SPINDL/ON, CLW, 1600
FEDRAT/500
FINI
```

### –ó–∞–ø—É—Å–∫ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞:

```bash
dotnet run -- -i test.apt -o output.nc -c siemens
```

### –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–û—Ç–∫—Ä–æ–π—Ç–µ `output.nc`:

```nc
(=== –ü—Ä–∏–≤–µ—Ç –æ—Ç Python –º–∞–∫—Ä–æ—Å–∞! ===)
N1 G0 X0. Y0. Z50.
(Program continues...)
```

üéâ **–ì–æ—Ç–æ–≤–æ!** –í—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –∏ –∑–∞–ø—É—Å—Ç–∏–ª–∏ –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å!

---

## –®–∞–≥ 4: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (5 –º–∏–Ω—É—Ç)

### StateCache ‚Äî –∫—ç—à —Å–æ—Å—Ç–æ—è–Ω–∏–π

–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ LAST_* –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞:

```python
# -*- coding: ascii -*-
def execute(context, command):
    feed = command.getNumeric(0, 0)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∫—ç—à
    if context.cacheHasChanged("LAST_FEED", feed):
        context.registers.f = feed
        context.writeBlock()
        context.cacheSet("LAST_FEED", feed)
```

### CycleCache ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–æ–≤

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä: –ø–æ–ª–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–∑–æ–≤:

```python
# -*- coding: ascii -*-
def execute(context, command):
    params = {
        'MODE': 1,
        'X': 100.0,
        'Y': 200.0,
        'Z': 50.0
    }
    
    # –£–º–Ω—ã–π –≤—ã–≤–æ–¥
    context.cycleWriteIfDifferent("CYCLE800", params)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```nc
; –ü–µ—Ä–≤—ã–π –≤—ã–∑–æ–≤ (–ø–æ–ª–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ)
CYCLE800(MODE=1, X=100.000, Y=200.000, Z=50.000)

; –í—Ç–æ—Ä–æ–π –≤—ã–∑–æ–≤ (—Ç–µ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã - —Ç–æ–ª—å–∫–æ –≤—ã–∑–æ–≤)
CYCLE800()
```

### NumericNCWord ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

```python
# -*- coding: ascii -*-
def execute(context, command):
    x = command.getNumeric(0, 0)
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    context.setNumericValue('X', x)
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
    xStr = context.getFormattedValue('X')  # "X100.500"
    
    context.writeBlock()
```

### TextNCWord ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å–æ —Å—Ç–∏–ª–µ–º

```python
# -*- coding: ascii -*-
def execute(context, command):
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∏–ª—å –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    context.comment("–ù–∞—á–∞–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–∏")
    
    # Siemens: (–ù–∞—á–∞–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–∏)
    # Haas: ; –ù–∞—á–∞–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–∏
```

---

## –®–∞–≥ 5: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –º–∞–∫—Ä–æ—Å (3 –º–∏–Ω—É—Ç—ã)

### –î–æ–±–∞–≤–ª—è–µ–º —á—Ç–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ò–∑–º–µ–Ω–∏–º –º–∞–∫—Ä–æ—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏–∑ APT:

```python
# -*- coding: ascii -*-
# GOTO —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏

def execute(context, command):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ GOTO —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏"""

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if not command.numeric or len(command.numeric) == 0:
        return

    # –ü–æ–ª—É—á–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    x = command.numeric[0]
    y = command.numeric[1] if len(command.numeric) > 1 else 0
    z = command.numeric[2] if len(command.numeric) > 2 else 0

    # –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä—ã
    context.registers.x = x
    context.registers.y = y
    context.registers.z = z

    # –í—ã–≤–æ–¥–∏–º G-–∫–æ–¥
    context.write(f"G1 X{x:.3f} Y{y:.3f} Z{z:.3f}")
```

### –¢–µ—Å—Ç–∏—Ä—É–µ–º

**APT:**
```apt
GOTO/100, 50, 10
```

**–í—ã–≤–æ–¥:**
```nc
N1 G1 X100.000 Y50.000 Z10.000
```

---

## üìö –ì–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –º–∞–∫—Ä–æ—Å–æ–≤

–ö–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–∏ —à–∞–±–ª–æ–Ω—ã –≤ `macros/python/user/` –∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã.

### –®–∞–±–ª–æ–Ω 1: –ë–∞–∑–æ–≤—ã–π GOTO

```python
# -*- coding: ascii -*-
# GOTO - –õ–∏–Ω–µ–π–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

def execute(context, command):
    """
    APT: GOTO/X, Y, Z

    –í—ã–≤–æ–¥: G1 X... Y... Z...
    """
    if not command.numeric:
        return

    x = command.numeric[0] if len(command.numeric) > 0 else context.registers.x
    y = command.numeric[1] if len(command.numeric) > 1 else context.registers.y
    z = command.numeric[2] if len(command.numeric) > 2 else context.registers.z

    context.registers.x = x
    context.registers.y = y
    context.registers.z = z

    context.write(f"G1 X{x:.3f} Y{y:.3f} Z{z:.3f}")
```

---

### –®–∞–±–ª–æ–Ω 2: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª–µ–º

```python
# -*- coding: ascii -*-
# SPINDL - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª–µ–º

def execute(context, command):
    """
    APT: SPINDL/ON, CLW, 1600
         SPINDL/OFF

    –í—ã–≤–æ–¥: M3 S... / M5
    """
    # –ü–æ–ª—É—á–∞–µ–º –æ–±–æ—Ä–æ—Ç—ã
    rpm = command.numeric[0] if command.numeric else 0
    context.registers.s = rpm

    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    state = "OFF"
    if command.minorWords:
        for word in command.minorWords:
            w = word.upper()
            if w in ["ON", "CLW", "CLOCKWISE"]:
                state = "CW"
            elif w in ["CCLW", "CCW"]:
                state = "CCW"
            elif w == "OFF":
                state = "OFF"

    # –í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥
    if state == "CW":
        context.write("M3")
        if rpm > 0:
            context.write(f"S{int(rpm)}")
    elif state == "CCW":
        context.write("M4")
        if rpm > 0:
            context.write(f"S{int(rpm)}")
    else:
        context.write("M5")
```

---

### –®–∞–±–ª–æ–Ω 3: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º

```python
# -*- coding: ascii -*-
# COOLNT - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º

def execute(context, command):
    """
    APT: COOLNT/ON
         COOLNT/FLOOD
         COOLNT/MIST
         COOLNT/OFF

    –í—ã–≤–æ–¥: M8 / M7 / M9
    """
    state = "FLOOD"  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é

    if command.minorWords:
        for word in command.minorWords:
            w = word.upper()
            if w in ["ON", "FLOOD"]:
                state = "FLOOD"
            elif w == "MIST":
                state = "MIST"
            elif w == "OFF":
                state = "OFF"

    if state == "FLOOD":
        context.write("M8")
    elif state == "MIST":
        context.write("M7")
    else:
        context.write("M9")
```

---

### –®–∞–±–ª–æ–Ω 4: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∞—á–µ–π (–º–æ–¥–∞–ª—å–Ω–æ–µ) —Å StateCache

```python
# -*- coding: ascii -*-
# FEDRAT - –ü–æ–¥–∞—á–∞ (–º–æ–¥–∞–ª—å–Ω–∞—è)

def execute(context, command):
    """
    APT: FEDRAT/500

    –í—ã–≤–æ–¥: F... (—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏)
    """
    if not command.numeric:
        return

    feed = command.numeric[0]
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ StateCache
    if context.cacheHasChanged("LAST_FEED", feed):
        context.registers.f = feed
        context.writeBlock()
        context.cacheSet("LAST_FEED", feed)
```

---

### –®–∞–±–ª–æ–Ω 5: –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

```python
# -*- coding: ascii -*-
# RAPID - –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

def execute(context, command):
    """
    APT: RAPID/X, Y, Z

    –í—ã–≤–æ–¥: G0 X... Y... Z...
    """
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∏–ø –¥–≤–∏–∂–µ–Ω–∏—è RAPID
    context.system.MOTION = "RAPID"
    context.currentMotionType = "RAPID"

    if not command.numeric:
        return

    x = command.numeric[0] if len(command.numeric) > 0 else context.registers.x
    y = command.numeric[1] if len(command.numeric) > 1 else context.registers.y
    z = command.numeric[2] if len(command.numeric) > 2 else context.registers.z

    context.registers.x = x
    context.registers.y = y
    context.registers.z = z

    context.write(f"G0 X{x:.3f} Y{y:.3f} Z{z:.3f}")
```

---

### –®–∞–±–ª–æ–Ω 6: –°–º–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

```python
# -*- coding: ascii -*-
# LOADTL - –°–º–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

def execute(context, command):
    """
    APT: LOADTL/5

    –í—ã–≤–æ–¥: T5 M6
    """
    if not command.numeric:
        context.warning("LOADTL —Ç—Ä–µ–±—É–µ—Ç –Ω–æ–º–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞")
        return

    new_tool = int(command.numeric[0])

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–æ—Ç –∂–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
    if context.globalVars.TOOL == new_tool:
        return

    context.registers.t = new_tool
    context.globalVars.TOOL = new_tool

    context.write(f"T{new_tool}")
    context.write("M6")
```

---

### –®–∞–±–ª–æ–Ω 7: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã

```python
# -*- coding: ascii -*-
# INIT - –ù–∞—á–∞–ª–æ –ø—Ä–æ–≥—Ä–∞–º–º—ã

def execute(context, command):
    """
    APT: PARTNO/NAME

    –í—ã–≤–æ–¥: –ó–∞–≥–æ–ª–æ–≤–æ–∫, –Ω–∞—á–∞–ª—å–Ω—ã–µ G-–∫–æ–¥—ã
    """
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—á–µ—Ç—á–∏–∫–æ–≤
    context.globalVars.SetInt("BLOCK_NUMBER", 1)
    context.globalVars.SetInt("BLOCK_INCREMENT", 2)
    context.globalVars.SetDouble("LAST_FEED", 0.0)

    # –ó–∞–≥–æ–ª–æ–≤–æ–∫
    context.comment(f"Program: {command.getString(0, 'UNKNOWN')}")
    context.comment(f"Date: {context.config.getParameterString('dateTime', 'N/A')}")

    # –ù–∞—á–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
    context.write("G54 G40 G90 G94 G17")
    context.write("G0 Z100.")
```

---

### –®–∞–±–ª–æ–Ω 8: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

```python
# -*- coding: ascii -*-
# FINI - –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã

def execute(context, command):
    """
    APT: FINI

    –í—ã–≤–æ–¥: –û—Ç–≤–æ–¥, M5, M9, M30
    """
    # –û—Ç–≤–æ–¥ –ø–æ Z
    context.write("G0 Z100.")

    # –í—ã–∫–ª—é—á–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª—è
    context.write("M5")

    # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
    context.write("M9")

    # –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã
    context.write("M30")
```

---

### –®–∞–±–ª–æ–Ω 9: –¶–∏–∫–ª —Å CycleCache

```python
# -*- coding: ascii -*-
# CYCLE800 - –ü–æ–≤–æ—Ä–æ—Ç–Ω–∞—è –æ—Å—å (—Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º)

def execute(context, command):
    """
    APT: CYCLE800/MODE, X, Y, Z, ...

    –í—ã–≤–æ–¥: CYCLE800(...) —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    """
    params = {
        'MODE': command.getNumeric(0, 1),
        'X': command.getNumeric(1, 0.0),
        'Y': command.getNumeric(2, 0.0),
        'Z': command.getNumeric(3, 0.0)
    }
    
    # –£–º–Ω—ã–π –≤—ã–≤–æ–¥ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
    context.cycleWriteIfDifferent("CYCLE800", params)
```

---

### –®–∞–±–ª–æ–Ω 10: NumericNCWord —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```python
# -*- coding: ascii -*-
# AXIS - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

def execute(context, command):
    """
    APT: AXIS/X, Y, Z

    –í—ã–≤–æ–¥: X... Y... Z... —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    """
    if not command.numeric:
        return

    x = command.getNumeric(0, 0)
    y = command.getNumeric(1, 0)
    z = command.getNumeric(2, 0)
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    context.setNumericValue('X', x)
    context.setNumericValue('Y', y)
    context.setNumericValue('Z', z)
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫
    xStr = context.getFormattedValue('X')  # "X100.500"
    yStr = context.getFormattedValue('Y')  # "Y200.750"
    zStr = context.getFormattedValue('Z')  # "Z50.250"
    
    context.writeBlock()
```

---

## üîß –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã API

### –í—ã–≤–æ–¥ G-–∫–æ–¥–∞

```python
context.write("G01 X100")              # –° –Ω–æ–º–µ—Ä–æ–º –±–ª–æ–∫–∞: N10 G01 X100
context.write("G01 X100", True)        # –ë–µ–∑ –Ω–æ–º–µ—Ä–∞ –±–ª–æ–∫–∞: G01 X100
context.comment("–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏")    # (–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏)
context.warning("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ!")     # (WARNING: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ!)
context.writeln()                       # –ü—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞
```

### –ß—Ç–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–º–∞–Ω–¥—ã

```python
# –ß–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
if command.numeric and len(command.numeric) > 0:
    x = command.numeric[0]

# –° default –∑–Ω–∞—á–µ–Ω–∏–µ–º
x = command.getNumeric(0, 0.0)
y = command.getNumeric(1, context.registers.y)

# –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
if command.hasMinorWord("on"):
    context.write("M3")

# –ü–µ—Ä–µ–±–æ—Ä –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
if command.minorWords:
    for word in command.minorWords:
        if word.upper() == "CLW":
            ...
```

### –†–∞–±–æ—Ç–∞ —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏

```python
# –ß—Ç–µ–Ω–∏–µ
x = context.registers.x
feed = context.registers.f

# –ó–∞–ø–∏—Å—å
context.registers.x = 100.5
context.registers.f = 500.0
context.registers.s = 2000
context.registers.t = 5
```

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

```python
# –ß—Ç–µ–Ω–∏–µ
last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
counter = context.globalVars.GetInt("COUNTER", 0)

# –ó–∞–ø–∏—Å—å
context.globalVars.SetDouble("LAST_FEED", 500.0)
context.globalVars.SetInt("COUNTER", 10)
```

### StateCache ‚Äî –∫—ç—à —Å–æ—Å—Ç–æ—è–Ω–∏–π (v1.1.0)

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
if context.cacheHasChanged("LAST_FEED", feed):
    context.writeBlock()
    context.cacheSet("LAST_FEED", feed)

# –°–±—Ä–æ—Å –∫—ç—à–∞
context.cacheReset("LAST_FEED")
```

### CycleCache ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–∏–∫–ª–æ–≤ (v1.1.0)

```python
# –£–º–Ω—ã–π –≤—ã–≤–æ–¥ —Ü–∏–∫–ª–∞
params = {'X': 100.0, 'Y': 200.0}
context.cycleWriteIfDifferent("CYCLE800", params)

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–ª–Ω—ã–π –≤—ã–≤–æ–¥
context.cycleForceWrite("CYCLE800", params)

# –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ —Ü–∏–∫–ª–∞
context.cycleCacheClear("CYCLE800")
```

### NumericNCWord ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (v1.1.0)

```python
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è
context.setNumericValue('X', 100.5)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
xStr = context.getFormattedValue('X')  # "X100.500"

# –ó–∞–ø–∏—Å—å –≤ –±–ª–æ–∫
context.writeBlock()
```

### TextNCWord ‚Äî —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (v1.1.0)

```python
# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (—Å—Ç–∏–ª—å –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
context.comment("–ù–∞—á–∞–ª–æ –æ–ø–µ—Ä–∞—Ü–∏–∏")

# –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ
context.note("–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ")

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
context.warning("–í–Ω–∏–º–∞–Ω–∏–µ!")
```

---

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –í—ã–≤–æ–¥ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

```python
def execute(context, command):
    context.comment(f"DEBUG: {command.majorWord}")
    context.comment(f"DEBUG: numeric={command.numeric}")
    context.comment(f"DEBUG: minorWords={command.minorWords}")
```

### –ó–∞–ø—É—Å–∫ —Å –æ—Ç–ª–∞–¥–∫–æ–π

```bash
dotnet run -- -i test.apt -o output.nc -c siemens --debug
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] –§–∞–π–ª –º–∞–∫—Ä–æ—Å–∞ –≤ –ø–∞–ø–∫–µ `macros/python/user/`
- [ ] –§–∞–π–ª –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `*.py`
- [ ] –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `def execute(context, command):`
- [ ] –ö–æ–¥–∏—Ä–æ–≤–∫–∞ `# -*- coding: ascii -*-` –≤ –Ω–∞—á–∞–ª–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

---

## üéì –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ò–∑—É—á–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

- [PYTHON_MACROS_GUIDE.md](PYTHON_MACROS_GUIDE.md) ‚Äî –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∞–∫—Ä–æ—Å–∞–º
- [CONFIGURATION_GUIDE.md](CONFIGURATION_GUIDE.md) ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤
- [ARCHITECTURE.md](ARCHITECTURE.md) ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã

- StateCache –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞
- CycleCache –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–∏–∫–ª–æ–≤
- NumericNCWord –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- TextNCWord –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

### –ü—Ä–∏–º–µ—Ä—ã –º–∞–∫—Ä–æ—Å–æ–≤

–ò–∑—É—á–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –º–∞–∫—Ä–æ—Å—ã –≤ `macros/python/base/`:
- `goto.py` ‚Äî –ª–∏–Ω–µ–π–Ω—ã–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
- `spindl.py` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª–µ–º
- `coolnt.py` ‚Äî –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ
- `cycle81.py` ‚Äî —Ü–∏–∫–ª—ã —Å–≤–µ—Ä–ª–µ–Ω–∏—è

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### Q: –ú–∞–∫—Ä–æ—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —á—Ç–æ –¥–µ–ª–∞—Ç—å?

**A:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –§–∞–π–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ?
2. –ï—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏—è `execute`?
3. –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫?

### Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å –∫–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É –∫–æ–º–∞–Ω–¥—ã?

**A:** –î–æ–±–∞–≤—å—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥:
```python
context.comment(f"DEBUG: numeric={command.numeric}")
context.comment(f"DEBUG: minorWords={command.minorWords}")
```

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python?

**A:** –î–∞, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç:
```python
import math

angle = math.degrees(math.atan2(j, k))
```

### Q: –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –º–∞–∫—Ä–æ—Å —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–µ–≥–æ —Å—Ç–∞–Ω–∫–∞?

**A:** –ü–æ–ª–æ–∂–∏—Ç–µ –º–∞–∫—Ä–æ—Å –≤ `macros/python/mmill/` –≤–º–µ—Å—Ç–æ `user/`.

---

## üéØ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 1: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ GOTO

–î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ Z:

```python
if z < 5:
    context.warning(f"Z={z} –Ω–∏–∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≤—ã—Å–æ—Ç—ã!")
    z = 5
```

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 2: –î–æ–±–∞–≤—å—Ç–µ –º—è–≥–∫–∏–π —Å—Ç–∞—Ä—Ç —à–ø–∏–Ω–¥–µ–ª—è

```python
if rpm > 1000:
    context.write("G04 P0.5")  # –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º
```

### –£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 3: –°–æ–∑–¥–∞–π—Ç–µ –º–∞–∫—Ä–æ—Å –¥–ª—è –ø–∞—É–∑—ã

```python
# DWELL MACRO
# APT: DWELL/2.5
# –í—ã–≤–æ–¥: G04 P2.5
```

---

**–£–¥–∞—á–∏ –≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –º–∞–∫—Ä–æ—Å–æ–≤! üöÄ**
