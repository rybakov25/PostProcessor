# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é Python –º–∞–∫—Ä–æ—Å–æ–≤

> **–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö** ‚Äî –æ—Ç –ø–µ—Ä–≤–æ–≥–æ –º–∞–∫—Ä–æ—Å–∞ –¥–æ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö —Ç–µ—Ö–Ω–∏–∫

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–í–≤–µ–¥–µ–Ω–∏–µ](#–≤–≤–µ–¥–µ–Ω–∏–µ)
2. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç-5-–º–∏–Ω—É—Ç)
3. [–û—Å–Ω–æ–≤—ã Python –¥–ª—è –º–∞–∫—Ä–æ—Å–æ–≤](#–æ—Å–Ω–æ–≤—ã-python-–¥–ª—è-–º–∞–∫—Ä–æ—Å–æ–≤)
4. [API –º–∞–∫—Ä–æ—Å–æ–≤](#api-–º–∞–∫—Ä–æ—Å–æ–≤)
5. [–ü—Ä–∏–º–µ—Ä—ã –º–∞–∫—Ä–æ—Å–æ–≤](#–ø—Ä–∏–º–µ—Ä—ã-–º–∞–∫—Ä–æ—Å–æ–≤)
6. [–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã](#–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ-—Ç–µ–º—ã)
7. [–û—Ç–ª–∞–¥–∫–∞](#–æ—Ç–ª–∞–¥–∫–∞)
8. [–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫](#—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫)
9. [–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏](#—á–∞—Å—Ç—ã–µ-–æ—à–∏–±–∫–∏)

---

## –í–≤–µ–¥–µ–Ω–∏–µ

### –ß—Ç–æ —Ç–∞–∫–æ–µ –º–∞–∫—Ä–æ—Å—ã?

**–ú–∞–∫—Ä–æ—Å—ã** ‚Äî —ç—Ç–æ Python-—Å–∫—Ä–∏–ø—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç APT-–∫–æ–º–∞–Ω–¥—ã –∏–∑ CAM-—Å–∏—Å—Ç–µ–º –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É—é—Ç –∏—Ö –≤ G-–∫–æ–¥ –¥–ª—è –≤–∞—à–µ–≥–æ —Å—Ç–∞–Ω–∫–∞ —Å –ß–ü–£.

```
APT-—Ñ–∞–π–ª (–∏–∑ CAM)  ‚Üí  –ü–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä  ‚Üí  Python –º–∞–∫—Ä–æ—Å—ã  ‚Üí  G-–∫–æ–¥ (–¥–ª—è —Å—Ç–∞–Ω–∫–∞)
```

### –ó–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã?

| –ó–∞–¥–∞—á–∞ | –†–µ—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∞–∫—Ä–æ—Å—ã |
|--------|----------------------|
| –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç G-–∫–æ–¥–∞ | –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç–µ Python-—Ñ–∞–π–ª |
| –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | –î–æ–±–∞–≤–ª—è–µ—Ç–µ —É—Å–ª–æ–≤–∏–µ –≤ –º–∞–∫—Ä–æ—Å |
| –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å 5-–æ—Å–µ–≤—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É | –ü–∏—à–µ—Ç–µ –ª–æ–≥–∏–∫—É –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ IJK‚ÜíABC |
| –ö–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–º–µ–Ω—É –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ | –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç–µ –º–∞–∫—Ä–æ—Å LOADTL |

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä?

```
1. –ß—Ç–µ–Ω–∏–µ APT-—Ñ–∞–π–ª–∞
   ‚Üì
2. –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥ (GOTO, SPINDL, COOLNT...)
   ‚Üì
3. –ü–æ–∏—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –º–∞–∫—Ä–æ—Å–∞ (.py —Ñ–∞–π–ª)
   ‚Üì
4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ execute(context, command)
   ‚Üì
5. –í—ã–≤–æ–¥ G-–∫–æ–¥–∞ —á–µ—Ä–µ–∑ context.write()
```

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω—É—Ç)

### –®–∞–≥ 1: –ù–∞–π–¥–∏—Ç–µ –ø–∞–ø–∫—É —Å –º–∞–∫—Ä–æ—Å–∞–º–∏

```
PostProcessor/
‚îî‚îÄ‚îÄ macros/
    ‚îî‚îÄ‚îÄ python/
        ‚îú‚îÄ‚îÄ base/      # –ë–∞–∑–æ–≤—ã–µ –º–∞–∫—Ä–æ—Å—ã (–¥–ª—è –≤—Å–µ—Ö —Å—Ç–∞–Ω–∫–æ–≤)
        ‚îî‚îÄ‚îÄ mmill/     # –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –≤–∞—à–µ–≥–æ —Å—Ç–∞–Ω–∫–∞
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `macros/python/user/hello.py`:

```python
# -*- coding: ascii -*-
# –ú–æ–π –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å

def execute(context, command):
    """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∞–∫—Ä–æ—Å"""
    context.comment("=== –ü—Ä–∏–≤–µ—Ç –æ—Ç Python –º–∞–∫—Ä–æ—Å–∞! ===")
    context.write("G0 X0 Y0 Z50")
```

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

```bash
dotnet run -- -i input.apt -o output.nc -c siemens
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–í –≤—ã—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ `output.nc` –ø–æ—è–≤–∏—Ç—Å—è:

```nc
(=== –ü—Ä–∏–≤–µ—Ç –æ—Ç Python –º–∞–∫—Ä–æ—Å–∞! ===)
N1 G0 X0. Y0. Z50.
```

üéâ **–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!** –í—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –º–∞–∫—Ä–æ—Å!

---

## –û—Å–Ω–æ–≤—ã Python –¥–ª—è –º–∞–∫—Ä–æ—Å–æ–≤

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

```python
# –ß–∏—Å–ª–∞ (int, float)
x = 100.5          # –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞
feed = 500         # –ø–æ–¥–∞—á–∞ –º–º/–º–∏–Ω
tool_number = 5    # –Ω–æ–º–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

# –°—Ç—Ä–æ–∫–∏ (str)
gcode = "G01"
comment = "–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏"

# –õ–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (bool)
is_rapid = True
has_tool = False

# –°–ø–∏—Å–∫–∏ (list)
coordinates = [100.0, 50.0, 10.0]
words = ["ON", "CLW"]
```

### –§—É–Ω–∫—Ü–∏–∏

```python
# –û–±—ä—è–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
def my_function(param1, param2):
    result = param1 + param2
    return result

# –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏
value = my_function(10, 20)  # value = 30
```

### –£—Å–ª–æ–≤–∏—è (if/elif/else)

```python
# –ü—Ä–æ—Å—Ç–æ–µ —É—Å–ª–æ–≤–∏–µ
if feed > 1000:
    context.warning("–ü–æ–¥–∞—á–∞ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∞—è!")

# –ï—Å–ª–∏-–∏–Ω–∞—á–µ
if spindle_state == "ON":
    context.write("M3")
else:
    context.write("M5")

# –ù–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π
if motion_type == "LINEAR":
    gcode = "G1"
elif motion_type == "RAPID":
    gcode = "G0"
else:
    gcode = "G1"  # –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

### –¶–∏–∫–ª—ã (for/while)

```python
# –ü–µ—Ä–µ–±–æ—Ä —Å–ø–∏—Å–∫–∞
for word in command.minorWords:
    if word.upper() == "ON":
        context.write("M3")

# –¶–∏–∫–ª —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º
for i in range(5):
    context.comment(f"–ò—Ç–µ—Ä–∞—Ü–∏—è {i}")

# –¶–∏–∫–ª while
count = 0
while count < 10:
    count += 1
```

---

## API –º–∞–∫—Ä–æ—Å–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –º–∞–∫—Ä–æ—Å–∞

–ö–∞–∂–¥—ã–π –º–∞–∫—Ä–æ—Å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `execute`:

```python
def execute(context, command):
    """
    –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–∞–∫—Ä–æ—Å–∞
    
    Args:
        context: –û–±—ä–µ–∫—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
        command: –û–±—ä–µ–∫—Ç APT-–∫–æ–º–∞–Ω–¥—ã
    """
    # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
    pass
```

---

### –û–±—ä–µ–∫—Ç `context` ‚Äî –≥–ª–∞–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –º–∞–∫—Ä–æ—Å–∞

#### –ú–µ—Ç–æ–¥—ã –≤—ã–≤–æ–¥–∞ G-–∫–æ–¥–∞

| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-------|----------|--------|
| `write(line)` | –í—ã–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É G-–∫–æ–¥–∞ | `context.write("G01 X100")` |
| `writeln(line)` | –í—ã–≤–µ—Å—Ç–∏ —Å—Ç—Ä–æ–∫—É –±–µ–∑ –Ω–æ–º–µ—Ä–∞ –±–ª–æ–∫–∞ | `context.writeln("")` |
| `comment(text)` | –í—ã–≤–µ—Å—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –≤ —Å–∫–æ–±–∫–∞—Ö | `context.comment("–ù–∞—á–∞–ª–æ")` |
| `warning(text)` | –í—ã–≤–µ—Å—Ç–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ | `context.warning("ZÂ§™‰Ωé!")` |

**–ü—Ä–∏–º–µ—Ä—ã:**

```python
# –í—ã–≤–æ–¥ G-–∫–æ–¥–∞ —Å –Ω–æ–º–µ—Ä–æ–º –±–ª–æ–∫–∞
context.write("G01 X100. Y50. Z10.")
# –í—ã–≤–æ–¥: N10 G01 X100. Y50. Z10.

# –í—ã–≤–æ–¥ –±–µ–∑ –Ω–æ–º–µ—Ä–∞ –±–ª–æ–∫–∞
context.write("G01 X100.", suppress_block=True)
# –í—ã–≤–æ–¥: G01 X100.

# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
context.comment("–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏")
# –í—ã–≤–æ–¥: (–ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏)

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
context.warning("Z=5 –Ω–∏–∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≤—ã—Å–æ—Ç—ã!")
# –í—ã–≤–æ–¥: (WARNING: Z=5 –Ω–∏–∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≤—ã—Å–æ—Ç—ã!)
```

---

#### –û–±—ä–µ–∫—Ç `context.registers` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä—ã —Å—Ç–∞–Ω–∫–∞

–†–µ–≥–∏—Å—Ç—Ä—ã —Ö—Ä–∞–Ω—è—Ç —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:

| –†–µ–≥–∏—Å—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `x`, `y`, `z` | float | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ª–∏–Ω–µ–π–Ω—ã—Ö –æ—Å–µ–π |
| `a`, `b`, `c` | float | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã—Ö –æ—Å–µ–π |
| `f` | float | –ü–æ–¥–∞—á–∞ (–º–º/–º–∏–Ω) |
| `s` | float | –û–±–æ—Ä–æ—Ç—ã —à–ø–∏–Ω–¥–µ–ª—è (–æ–±/–º–∏–Ω) |
| `t` | int | –ù–æ–º–µ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ |
| `i`, `j`, `k` | float | –í–µ–∫—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–ª—è 5-–æ—Å–∏) |

**–ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å:**

```python
# –ß—Ç–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
current_x = context.registers.x
current_feed = context.registers.f

# –ó–∞–ø–∏—Å—å –Ω–æ–≤–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
context.registers.x = 100.5
context.registers.y = 50.0
context.registers.z = 10.0
context.registers.f = 500.0
context.registers.s = 2000
context.registers.t = 5
```

---

#### –û–±—ä–µ–∫—Ç `context.config` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞

```python
# –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
name = context.config.name              # "Siemens 840D"
profile = context.config.machineProfile # "mmill_01"

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
safe_z = context.config.safety.retractPlane      # 5.0
max_z = context.config.safety.clearancePlane     # 100.0
max_feed = context.config.safety.maxFeedRate     # 10000.0
max_rpm = context.config.safety.maxSpindleSpeed  # 12000.0

# 5-–æ—Å–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
enable_5axis = context.config.multiAxis.enableRtcp  # True/False
max_a = context.config.multiAxis.maxA               # 120.0
min_a = context.config.multiAxis.minA               # -120.0
max_b = context.config.multiAxis.maxB               # 360.0
```

**M-–∫–æ–¥—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```python
# –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ context.config.mcode
m3 = context.config.mcode.spindleCW      # "M3"
m5 = context.config.mcode.spindleStop    # "M5"
m8 = context.config.mcode.coolantOn      # "M8"
m6 = context.config.mcode.toolChange     # "M6"
m30 = context.config.mcode.programEnd    # "M30"
```

---

#### –û–±—ä–µ–∫—Ç `context.system` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (SYSTEM.*)

–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞:

```python
# –¢–∏–ø –¥–≤–∏–∂–µ–Ω–∏—è
motion = context.system.MOTION  # "LINEAR", "RAPID", "CYCLE"
context.system.MOTION = "RAPID"

# –ò–º—è —Ä–µ–≥–∏—Å—Ç—Ä–∞ —à–ø–∏–Ω–¥–µ–ª—è
spindle_name = context.system.SPINDLE_NAME  # "S"

# –¢–∏–ø —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
tech_type = context.system.TECHNOLOGY_TYPE  # "MILLING", "TURNING", "ALL"

# –î–ª–∏–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
tool_length = context.system.TOOL_LENGTH

# –¢–∏–ø –¥—É–≥–∏
circle_type = context.system.CIRCTYPE

# LINTOL (–ª–∏–Ω–µ–π–Ω—ã–π –¥–æ–ø—É—Å–∫)
lintol = context.system.LINTOL
lintol_linear = context.system.LINTOL_LINEAR
lintol_rotary = context.system.LINTOL_ROTARY
```

**–ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:**

```python
# –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
value = context.system.GetInt("BLOCK_NUMBER", 1)
value = context.system.GetDouble("FEED_PROG", 100.0)
value = context.system.GetBool("TOOLCHNG", False)
value = context.system["CUSTOM_VAR"]

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
context.system.SetInt("BLOCK_NUMBER", 10)
context.system.SetDouble("FEED_PROG", 500.0)
context.system.SetBool("TOOLCHNG", True)
context.system["CUSTOM_VAR"] = "value"
```

---

#### –û–±—ä–µ–∫—Ç `context.globalVars` ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (GLOBAL.*)

–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏ –º–∞–∫—Ä–æ—Å–æ–≤:

```python
# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —à–ø–∏–Ω–¥–µ–ª—è
spindle_def = context.globalVars.SPINDLE_DEF      # "CLW", "CCLW", "OFF"
spindle_rpm = context.globalVars.SPINDLE_RPM      # 1600.0
spindle_block = context.globalVars.SPINDLE_BLOCK  # 0 –∏–ª–∏ 1

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
tool = context.globalVars.TOOL                    # —Ç–µ–∫—É—â–∏–π –Ω–æ–º–µ—Ä
ftool = context.globalVars.FTOOL                  # –ø–µ—Ä–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
hval = context.globalVars.HVAL                    # –Ω–æ–º–µ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–æ—Ä–∞
toolchng = context.globalVars.TOOLCHNG            # —Ñ–ª–∞–≥ —Å–º–µ–Ω—ã

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
coolant_def = context.globalVars.COOLANT_DEF      # "FLOOD", "MIST", "OFF"
coolant_block = context.globalVars.COOLANT_BLOCK

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥–∞—á–∏
feed_block = context.globalVars.FEED_BLOCK
feed_prog = context.globalVars.FEED_PROG
feedmode = context.globalVars.FEEDMODE            # "FPM", "FPR", "FIT"

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–≤–∏–∂–µ–Ω–∏—è
linear_type = context.globalVars.LINEAR_TYPE
rapid_type = context.globalVars.RAPID_TYPE

# –°—Ç—Ä–∞—Ç–µ–≥–∏–∏
strategy_rtcp = context.globalVars.STRATEGY_RTCP
strategy_3x_milling = context.globalVars.STRATEGY_3X_MILLING
```

**–ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:**

```python
# –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
block_num = context.globalVars.GetInt("BLOCK_NUMBER", 1)

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
context.globalVars.SetDouble("LAST_FEED", 500.0)
context.globalVars.SetInt("BLOCK_NUMBER", 10)
context.globalVars.SetBool("TOOLCHNG", True)
```

---

### –û–±—ä–µ–∫—Ç `command` ‚Äî APT-–∫–æ–º–∞–Ω–¥–∞

#### –°–≤–æ–π—Å—Ç–≤–∞ –∫–æ–º–∞–Ω–¥—ã

| –°–≤–æ–π—Å—Ç–≤–æ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|-----|----------|--------|
| `majorWord` | str | –û—Å–Ω–æ–≤–Ω–æ–µ —Å–ª–æ–≤–æ –∫–æ–º–∞–Ω–¥—ã | `"goto"`, `"spindl"` |
| `lineNumber` | int | –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ APT | `42` |
| `numeric` | list[float] | –ß–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | `[100.0, 50.0, 10.0]` |
| `strings` | list[str] | –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | `["PART_NAME"]` |
| `minorWords` | list[str] | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ | `["on", "clw"]` |

**–ü—Ä–∏–º–µ—Ä—ã APT-–∫–æ–º–∞–Ω–¥:**

```
GOTO/100, 50, 10
‚îú‚îÄ‚îÄ majorWord: "goto"
‚îî‚îÄ‚îÄ numeric: [100.0, 50.0, 10.0]

SPINDL/ON, CLW, 1600
‚îú‚îÄ‚îÄ majorWord: "spindl"
‚îú‚îÄ‚îÄ minorWords: ["on", "clw"]
‚îî‚îÄ‚îÄ numeric: [1600.0]

COOLNT/FLOOD
‚îú‚îÄ‚îÄ majorWord: "coolnt"
‚îî‚îÄ‚îÄ minorWords: ["flood"]

LOADTL/5, ADJUST, 1, MILL
‚îú‚îÄ‚îÄ majorWord: "loadtl"
‚îú‚îÄ‚îÄ numeric: [5.0, 1.0]
‚îî‚îÄ‚îÄ minorWords: ["adjust", "mill"]
```

#### –ú–µ—Ç–æ–¥—ã –∫–æ–º–∞–Ω–¥—ã

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
if command.hasMinorWord("on"):
    context.write("M3")

if command.hasMinorWord("off"):
    context.write("M5")

# –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å default
x = command.getNumeric(0, 0.0)  # –ü–µ—Ä–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–ª–∏ 0.0
y = command.getNumeric(1, context.registers.y)  # –í—Ç–æ—Ä–æ–π –∏–ª–∏ —Ç–µ–∫—É—â–∏–π
name = command.getString(0, "DEFAULT")  # –ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ "DEFAULT"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
if command.numeric and len(command.numeric) > 0:
    x = command.numeric[0]

if command.minorWords:
    for word in command.minorWords:
        # –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
```

---

## –ü—Ä–∏–º–µ—Ä—ã –º–∞–∫—Ä–æ—Å–æ–≤

### –ü—Ä–∏–º–µ—Ä 1: GOTO ‚Äî –ª–∏–Ω–µ–π–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

**APT:** `GOTO/100, 50, 10`

**–ú–∞–∫—Ä–æ—Å (`base/goto.py`):**

```python
# -*- coding: ascii -*-
# GOTO MACRO - Linear Motion

def execute(context, command):
    """
    Process GOTO linear motion command
    
    APT format: GOTO/X, Y, Z [, I, J, K]
    - X, Y, Z ‚Äî –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
    - I, J, K ‚Äî –≤–µ–∫—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–¥–ª—è 5-–æ—Å–∏)
    """
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    if not command.numeric or len(command.numeric) == 0:
        return
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    x = command.numeric[0] if len(command.numeric) > 0 else context.registers.x
    y = command.numeric[1] if len(command.numeric) > 1 else context.registers.y
    z = command.numeric[2] if len(command.numeric) > 2 else context.registers.z
    
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
    context.registers.x = x
    context.registers.y = y
    context.registers.z = z
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–≤–∏–∂–µ–Ω–∏—è
    motion_type = context.system.MOTION
    is_rapid = (motion_type == "RAPID" or context.currentMotionType == "RAPID")
    
    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ G-–∫–æ–¥–∞
    if is_rapid:
        gcode = "G0"
        # –°–±—Ä–æ—Å —Ç–∏–ø–∞ –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ RAPID
        context.system.MOTION = "LINEAR"
        context.currentMotionType = "LINEAR"
    else:
        gcode = "G1"
    
    # –í—ã–≤–æ–¥ –¥–≤–∏–∂–µ–Ω–∏—è
    line = f"{gcode} X{format_num(x)}"
    if len(command.numeric) > 1:
        line += f" Y{format_num(y)}"
    if len(command.numeric) > 2:
        line += f" Z{format_num(z)}"
    
    context.write(line)
    
    # –í—ã–≤–æ–¥ –ø–æ–¥–∞—á–∏ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Äî –º–æ–¥–∞–ª—å–Ω–æ)
    if context.registers.f > 0:
        last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
        if last_feed != context.registers.f:
            context.write(f"F{context.registers.f:.1f}")
            context.globalVars.SetDouble("LAST_FEED", context.registers.f)


def format_num(value):
    """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –Ω—É–ª–µ–π"""
    rounded = round(value, 3)
    formatted = str(rounded).rstrip('0').rstrip('.')
    if '.' not in formatted:
        formatted += '.'
    return formatted
```

**–í—ã–≤–æ–¥:**
```nc
N10 G1 X100. Y50. Z10.
N12 F500.0
```

---

### –ü—Ä–∏–º–µ—Ä 2: RAPID ‚Äî –±—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ

**APT:** `RAPID/200, 100, 50`

**–ú–∞–∫—Ä–æ—Å (`base/rapid.py`):**

```python
# -*- coding: ascii -*-
# RAPID MACRO - Rapid Positioning

def execute(context, command):
    """
    Process RAPID positioning command
    
    –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç SYSTEM.MOTION = RAPID –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
    """
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∏–ø–∞ –¥–≤–∏–∂–µ–Ω–∏—è RAPID
    context.system.MOTION = "RAPID"
    context.currentMotionType = "RAPID"
    
    # –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Äî –≤—ã–≤–æ–¥–∏–º G0 —Å—Ä–∞–∑—É
    if command.numeric and len(command.numeric) > 0:
        x = command.numeric[0] if len(command.numeric) > 0 else context.registers.x
        y = command.numeric[1] if len(command.numeric) > 1 else context.registers.y
        z = command.numeric[2] if len(command.numeric) > 2 else context.registers.z
        
        context.registers.x = x
        context.registers.y = y
        context.registers.z = z
        
        line = f"G0 X{format_num(x)}"
        if len(command.numeric) > 1:
            line += f" Y{format_num(y)}"
        if len(command.numeric) > 2:
            line += f" Z{format_num(z)}"
        
        context.write(line)


def format_num(value):
    rounded = round(value, 3)
    formatted = str(rounded).rstrip('0').rstrip('.')
    if '.' not in formatted:
        formatted += '.'
    return formatted
```

**–í—ã–≤–æ–¥:**
```nc
N10 G0 X200. Y100. Z50.
```

---

### –ü—Ä–∏–º–µ—Ä 3: SPINDL ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª–µ–º

**APT:** `SPINDL/ON, CLW, 1600`

**–ú–∞–∫—Ä–æ—Å (`base/spindl.py`):**

```python
# -*- coding: ascii -*-
# SPINDL MACRO - Spindle Control

def execute(context, command):
    """
    Process SPINDL spindle control command
    
    APT Examples:
      SPINDL/ON, CLW, 1600    ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø–æ —á–∞—Å–æ–≤–æ–π, 1600 –æ–±/–º–∏–Ω
      SPINDL/OFF              ‚Äî –≤—ã–∫–ª—é—á–∏—Ç—å
      SPINDL/1200             ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 1200 –æ–±/–º–∏–Ω
    """
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–æ—Ä–æ—Ç–æ–≤ –∏–∑ —á–∏—Å–ª–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if command.numeric and len(command.numeric) > 0:
        context.globalVars.SPINDLE_RPM = command.numeric[0]
    
    context.registers.s = context.globalVars.SPINDLE_RPM
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —à–ø–∏–Ω–¥–µ–ª—è
    spindle_state = context.globalVars.SPINDLE_DEF
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
    if command.minorWords:
        for word in command.minorWords:
            word_upper = word.upper()
            
            if word_upper in ["ON", "CLW", "CLOCKWISE"]:
                spindle_state = "CLW"
                context.globalVars.SPINDLE_DEF = "CLW"
                
            elif word_upper in ["CCLW", "CCW", "COUNTER-CLOCKWISE"]:
                spindle_state = "CCLW"
                context.globalVars.SPINDLE_DEF = "CCLW"
                
            elif word_upper == "ORIENT":
                spindle_state = "ORIENT"
                
            elif word_upper == "OFF":
                spindle_state = "OFF"
    
    # –í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
    if spindle_state == "CLW":
        context.write("M3")
        if context.globalVars.SPINDLE_RPM > 0:
            context.write(f"S{int(context.globalVars.SPINDLE_RPM)}")
            
    elif spindle_state == "CCLW":
        context.write("M4")
        if context.globalVars.SPINDLE_RPM > 0:
            context.write(f"S{int(context.globalVars.SPINDLE_RPM)}")
            
    elif spindle_state == "ORIENT":
        context.write("M19")
        
    else:  # OFF
        context.write("M5")
```

**–í—ã–≤–æ–¥:**
```nc
N10 M3
N12 S1600
```

---

### –ü—Ä–∏–º–µ—Ä 4: FEDRAT ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∞—á–µ–π

**APT:** `FEDRAT/500`

**–ú–∞–∫—Ä–æ—Å (`base/fedrat.py`):**

```python
# -*- coding: ascii -*-
# FEDRAT MACRO - Feed Rate (MODAL)

def execute(context, command):
    """
    Process FEDRAT feed rate command
    
    –ü–æ–¥–∞—á–∞ –ú–û–î–ê–õ–¨–ù–ê ‚Äî –≤—ã–≤–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    """
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if not command.numeric or len(command.numeric) == 0:
        return
    
    feed = command.numeric[0]
    
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞
    context.registers.f = feed
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å)
    last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
    if last_feed == feed:
        return  # –¢–∞ –∂–µ –ø–æ–¥–∞—á–∞ ‚Äî –Ω–µ –≤—ã–≤–æ–¥–∏–º
    
    # –ü–æ–¥–∞—á–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å ‚Äî –≤—ã–≤–æ–¥–∏–º –∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ–º
    context.globalVars.SetDouble("LAST_FEED", feed)
    context.write(f"F{round(feed, 1)}")
```

**–í—ã–≤–æ–¥:**
```nc
N10 F500.0
```

---

### –ü—Ä–∏–º–µ—Ä 5: COOLNT ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º

**APT:** `COOLNT/FLOOD`

**–ú–∞–∫—Ä–æ—Å (`base/coolnt.py`):**

```python
# -*- coding: ascii -*-
# COOLNT MACRO - Coolant Control

def execute(context, command):
    """
    Process COOLNT coolant control command
    
    APT Examples:
      COOLNT/ON       ‚Äî –≤–∫–ª—é—á–∏—Ç—å –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ
      COOLNT/FLOOD    ‚Äî –≤–∫–ª—é—á–∏—Ç—å –∂–∏–¥–∫–æ—Å—Ç–Ω–æ–µ
      COOLNT/MIST     ‚Äî –≤–∫–ª—é—á–∏—Ç—å —Ç—É–º–∞–Ω
      COOLNT/OFF      ‚Äî –≤—ã–∫–ª—é—á–∏—Ç—å
    """
    
    coolant_state = context.globalVars.COOLANT_DEF
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
    if command.minorWords:
        for word in command.minorWords:
            word_upper = word.upper()
            
            if word_upper in ["ON", "FLOOD"]:
                coolant_state = "FLOOD"
                context.globalVars.COOLANT_DEF = "FLOOD"
                
            elif word_upper == "MIST":
                coolant_state = "MIST"
                context.globalVars.COOLANT_DEF = "MIST"
                
            elif word_upper == "OFF":
                coolant_state = "OFF"
                context.globalVars.COOLANT_DEF = "OFF"
    
    # –í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥
    if coolant_state == "FLOOD":
        context.write("M8")
    elif coolant_state == "MIST":
        context.write("M7")
    else:  # OFF
        context.write("M9")
```

**–í—ã–≤–æ–¥:**
```nc
N10 M8
```

---

### –ü—Ä–∏–º–µ—Ä 6: LOADTL ‚Äî —Å–º–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (–¥–ª—è MMILL)

**APT:** `LOADTL/5, ADJUST, 1, MILL`

**–ú–∞–∫—Ä–æ—Å (`mmill/loadtl.py`):**

```python
# -*- coding: ascii -*-
# MMILL LOADTL MACRO - Tool Change

_block_number = 70  # –ù–∞—á–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –±–ª–æ–∫–∞

def execute(context, command):
    """
    Process LOADTL for MMILL
    
    –î–æ–±–∞–≤–ª—è–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
    - RTCPON –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã
    - M101H0 (–∑–∞–∂–∏–º –≥–æ–ª–æ–≤—ã)
    - G0 B0 (–ø–æ–≤–æ—Ä–æ—Ç –æ—Å–∏ B)
    """
    
    global _block_number
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
    if context.globalVars.TOOLCHG_IGNORE_SAME:
        new_tool = int(command.numeric[0]) if command.numeric else 0
        if context.globalVars.TOOL == new_tool:
            return  # –¢–æ—Ç –∂–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
    if command.numeric:
        context.globalVars.TOOL = int(command.numeric[0])
    
    context.globalVars.HVAL = 1
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ —à–ø–∏–Ω–¥–µ–ª—è
    spindle_speed = command.numeric[1] if len(command.numeric) > 1 else 1600
    context.registers.s = spindle_speed
    
    # –í—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥ —Å–º–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
    context.write(f"N{_block_number} T{context.globalVars.TOOL}")
    _block_number += 10
    
    context.write(f"N{_block_number} D1")
    _block_number += 10
    
    context.write(f"N{_block_number} M6")
    _block_number += 10
    
    # –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã MMILL
    context.write(f"N{_block_number} G0 B0")
    _block_number += 10
    
    context.write(f"N{_block_number} M101H0")
    _block_number += 10
    
    context.write(f"N{_block_number} RTCPON")
    _block_number += 10
    
    # –í–∫–ª—é—á–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª—è
    context.write(f"N{_block_number} S{int(spindle_speed)} M3")
    _block_number += 10
    
    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–æ–≤
    context.globalVars.TOOLCHNG = 1
    context.globalVars.FTOOL = context.globalVars.TOOL
```

**–í—ã–≤–æ–¥:**
```nc
N70 T5
N80 D1
N90 M6
N100 G0 B0
N110 M101H0
N120 RTCPON
N130 S1600 M3
```

---

### –ü—Ä–∏–º–µ—Ä 7: INIT ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã

**APT:** `PARTNO/DETAIL_NAME`

**–ú–∞–∫—Ä–æ—Å (`mmill/init.py`):**

```python
# MMILL INIT MACRO

def execute(context, command):
    """
    –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è MMILL
    
    –í—ã–≤–æ–¥–∏—Ç:
    - –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
    - –ù–∞—á–∞–ª—å–Ω—ã–µ G-–∫–æ–¥—ã
    - CYCLE800 –¥–ª—è 5-–æ—Å–∏
    """
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –±–ª–æ–∫–æ–≤
    context.globalVars.SetInt("BLOCK_NUMBER", 1)
    context.globalVars.SetInt("BLOCK_INCREMENT", 2)
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–¥–∞—á–∏
    context.globalVars.SetDouble("LAST_FEED", 0.0)
    
    # –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
    header = context.config.header
    if header and header.enabled:
        for line in header.lines:
            context.write(line.format(
                company="Company Name",
                machine="Machine Name",
                inputFile=context.config.getParameterString("inputFile", "unknown"),
                dateTime=context.config.getParameterString("dateTime", "unknown")
            ), suppress_block=True)
    
    # –ù–∞—á–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏
    context.write("G54 G40 G90 G94 CUT2DF G17")
    context.write("TRANS")
    context.write("RTCPOF")
    
    # CYCLE800 –¥–ª—è 5-–æ—Å–∏
    cycle = context.machine.config.fiveAxis.cycle800
    params = cycle.parameters
    context.write('CYCLE800({},"{}",{},{},{},{},{},{},{},{},{},{},{},{},{},{})'.format(
        params['mode'], params['table'], params['rotation'], params['plane'],
        params.get('x', 0), params.get('y', 0), params.get('z', 0),
        params.get('a', 0), params.get('b', 0), params.get('c', 0),
        params.get('dx', 0), params.get('dy', 0), params.get('dz', 0),
        params['direction'], params['feed'], params['maxFeed']
    ))
    
    context.write("G64 SOFT FFWON")
    context.write(context.machine.config.head.clampCommand + "; TCB6 HEAD")
```

**–í—ã–≤–æ–¥:**
```nc
(Program header...)
N1 G54 G40 G90 G94 CUT2DF G17
N2 TRANS
N3 RTCPOF
N4 CYCLE800(...)
N5 G64 SOFT FFWON
N6 M101; TCB6 HEAD
```

---

### –ü—Ä–∏–º–µ—Ä 8: FINI ‚Äî –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

**APT:** `FINI`

**–ú–∞–∫—Ä–æ—Å (`mmill/fini.py`):**

```python
# -*- coding: ascii -*-
# MMILL FINI MACRO - End of Program

def execute(context, command):
    """
    –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è MMILL
    
    –í—ã–≤–æ–¥–∏—Ç:
    - –û—Ç–≤–æ–¥ –ø–æ Z
    - –í—ã–∫–ª—é—á–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª—è –∏ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
    - –í—ã–∫–ª—é—á–µ–Ω–∏–µ RTCP
    - –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã M30
    """
    
    # –û—Ç–≤–æ–¥ –ø–æ Z
    context.write("G0 Z100.")
    
    # –í—ã–∫–ª—é—á–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª—è
    context.write("M5")
    
    # –í—ã–∫–ª—é—á–µ–Ω–∏–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
    context.write("M9")
    
    # –í—ã–∫–ª—é—á–µ–Ω–∏–µ RTCP
    context.write("RTCPOF")
    
    # –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã
    context.write("M30")
```

**–í—ã–≤–æ–¥:**
```nc
N100 G0 Z100.
N102 M5
N104 M9
N106 RTCPOF
N108 M30
```

---

## –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ–º—ã

### –ú–æ–¥–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

**–ú–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å** –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ –æ—Ç–º–µ–Ω—ã –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è.

```python
# –ü—Ä–∏–º–µ—Ä –º–æ–¥–∞–ª—å–Ω–æ–π –ø–æ–¥–∞—á–∏
def execute(context, command):
    feed = command.numeric[0]
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –ª–∏ –ø–æ–¥–∞—á–∞
    last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
    
    if last_feed == feed:
        return  # –ù–µ –≤—ã–≤–æ–¥–∏–º ‚Äî —É–∂–µ –∞–∫—Ç–∏–≤–Ω–∞
    
    # –í—ã–≤–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    context.globalVars.SetDouble("LAST_FEED", feed)
    context.write(f"F{feed:.1f}")
```

**–ú–æ–¥–∞–ª—å–Ω—ã–µ G-–∫–æ–¥—ã:**
- G0/G1 ‚Äî —Ç–∏–ø –¥–≤–∏–∂–µ–Ω–∏—è
- G17/G18/G19 ‚Äî –ø–ª–æ—Å–∫–æ—Å—Ç—å –¥—É–≥–∏
- G90/G91 ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ/–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
- G54-G59 ‚Äî —Ä–∞–±–æ—á–∏–µ —Å–∏—Å—Ç–µ–º—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç

---

### 5-–æ—Å–µ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (IJK ‚Üí ABC)

–î–ª—è 5-–æ—Å–µ–≤—ã—Ö —Å—Ç–∞–Ω–∫–æ–≤ –≤–µ–∫—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (I,J,K) –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —É–≥–ª—ã –ø–æ–≤–æ—Ä–æ—Ç–∞ (A,B,C).

```python
import math

def ijk_to_abc(i, j, k):
    """
    –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è IJK –≤–µ–∫—Ç–æ—Ä–∞ –≤ ABC —É–≥–ª—ã
    
    –î–ª—è Siemens 840D:
    - A = –≤—Ä–∞—â–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ X
    - B = –≤—Ä–∞—â–µ–Ω–∏–µ –≤–æ–∫—Ä—É–≥ Y
    """
    # A —É–≥–æ–ª (–≤–æ–∫—Ä—É–≥ X)
    a = math.degrees(math.atan2(j, k))
    
    # B —É–≥–æ–ª (–≤–æ–∫—Ä—É–≥ Y)
    b = math.degrees(math.atan2(i, math.sqrt(j*j + k*k)))
    
    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫ 0-360
    if a < 0:
        a += 360
    if b < 0:
        b += 360
    
    return round(a, 3), round(b, 3), 0.0


# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–∞–∫—Ä–æ—Å–µ GOTO
def execute(context, command):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ IJK
    i = command.numeric[3] if len(command.numeric) > 3 else None
    j = command.numeric[4] if len(command.numeric) > 4 else None
    k = command.numeric[5] if len(command.numeric) > 5 else None
    
    if i is not None and j is not None and k is not None:
        # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ ABC
        a, b, c = ijk_to_abc(i, j, k)
        
        context.registers.a = a
        context.registers.b = b
        
        # –í—ã–≤–æ–¥ —Å –ø–æ–≤–æ—Ä–æ—Ç–Ω—ã–º–∏ –æ—Å—è–º–∏
        context.write(f"G1 X{x:.3f} Y{y:.3f} Z{z:.3f} A{a:.3f} B{b:.3f}")
```

---

### –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

**–ß—Ç–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

```python
# –ò–∑ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å—Ç–∞–Ω–∫–∞
use_soft_start = context.config.getParameterBool("softStart", False)
feed_override = context.config.getParameterDouble("feedOverride", 100.0)
custom_code = context.config.getParameterString("footerCode", "M30")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–∞–∫—Ä–æ—Å–µ
if use_soft_start:
    context.write("G04 P1.0")  # –ü–∞—É–∑–∞ 1 —Å–µ–∫—É–Ω–¥–∞
```

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`configs/machines/my_machine.json`):**

```json
{
  "name": "My Custom Machine",
  "machineProfile": "custom_01",
  "customParameters": {
    "softStart": true,
    "feedOverride": 120.0,
    "useCustomFeature": true,
    "footerCode": "M30"
  },
  "customGCodes": {
    "rapidOverride": "G00.1"
  },
  "customMCodes": {
    "toolClamp": "M10",
    "toolUnclamp": "M11"
  }
}
```

---

### –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

**–°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```python
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è
context.globalVars.SetDouble("CUSTOM_FEED", 500.0)
context.globalVars.SetInt("CUSTOM_COUNTER", 10)
context.globalVars.SetBool("CUSTOM_FLAG", True)
context.globalVars["CUSTOM_STRING"] = "value"

# –ß—Ç–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
feed = context.globalVars.GetDouble("CUSTOM_FEED", 0.0)
counter = context.globalVars.GetInt("CUSTOM_COUNTER", 0)
flag = context.globalVars.GetBool("CUSTOM_FLAG", False)
value = context.globalVars["CUSTOM_STRING"]
```

---

## –û—Ç–ª–∞–¥–∫–∞

### –í—ã–≤–æ–¥ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

```python
def execute(context, command):
    # –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–º–∞–Ω–¥–µ
    context.comment(f"DEBUG: majorWord={command.majorWord}")
    context.comment(f"DEBUG: numeric={command.numeric}")
    context.comment(f"DEBUG: minorWords={command.minorWords}")
    context.comment(f"DEBUG: lineNumber={command.lineNumber}")
    
    # –í—ã–≤–æ–¥ —Ç–µ–∫—É—â–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
    context.comment(f"DEBUG: X={context.registers.x}")
    context.comment(f"DEBUG: F={context.registers.f}")
    
    # –í—ã–≤–æ–¥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    context.comment(f"DEBUG: MOTION={context.system.MOTION}")
```

### –ó–∞–ø—É—Å–∫ —Å debug-—Ñ–ª–∞–≥–æ–º

```bash
dotnet run -- -i input.apt -o output.nc -c siemens --debug
```

### –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞

–õ–æ–≥–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å —Ñ–ª–∞–≥–æ–º `--debug`.

---

## –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫

### –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã APT

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –ú–∞–∫—Ä–æ—Å |
|---------|----------|--------|
| `GOTO` | –õ–∏–Ω–µ–π–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ | `base/goto.py` |
| `RAPID` | –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ | `base/rapid.py` |
| `SPINDL` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–ø–∏–Ω–¥–µ–ª–µ–º | `base/spindl.py` |
| `COOLNT` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º | `base/coolnt.py` |
| `FEDRAT` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∞—á–µ–π | `base/fedrat.py` |
| `LOADTL` | –°–º–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ | `mmill/loadtl.py` |
| `PARTNO` | –ù–∞—á–∞–ª–æ –ø—Ä–æ–≥—Ä–∞–º–º—ã | `mmill/init.py` |
| `FINI` | –ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã | `mmill/fini.py` |
| `RTCP` | –í–∫–ª/–≤—ã–∫–ª RTCP | `mmill/rtcp.py` |
| `ROTATE` | –ü–æ–≤–æ—Ä–æ—Ç —Å—Ç–æ–ª–∞ | `mmill/rotabl.py` |

---

### –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã context

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| `context.registers` | PythonRegisters | –†–µ–≥–∏—Å—Ç—Ä—ã —Å—Ç–∞–Ω–∫–∞ |
| `context.config` | PythonConfig | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ |
| `context.machine` | PythonMachineState | –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–∞—à–∏–Ω—ã |
| `context.system` | PythonSystemVariables | –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ |
| `context.globalVars` | PythonGlobalVariables | –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ |
| `context.currentFeed` | float | –¢–µ–∫—É—â–∞—è –ø–æ–¥–∞—á–∞ |
| `context.currentMotionType` | str | –¢–µ–∫—É—â–∏–π —Ç–∏–ø –¥–≤–∏–∂–µ–Ω–∏—è |

---

### –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã command

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|----------|
| `command.majorWord` | str | –û—Å–Ω–æ–≤–Ω–æ–µ —Å–ª–æ–≤–æ –∫–æ–º–∞–Ω–¥—ã |
| `command.lineNumber` | int | –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –≤ APT |
| `command.numeric` | list[float] | –ß–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |
| `command.strings` | list[str] | –°—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |
| `command.minorWords` | list[str] | –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ |

| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|
| `hasMinorWord(word)` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ |
| `getNumeric(index, default)` | –ü–æ–ª—É—á–∏—Ç—å —á–∏—Å–ª–æ —Å default |
| `getString(index, default)` | –ü–æ–ª—É—á–∏—Ç—å —Å—Ç—Ä–æ–∫—É —Å default |

---

### –§–æ—Ä–º–∞—Ç—ã —á–∏—Å–µ–ª

```python
# –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ
rounded = context.round(3.14159, 2)  # 3.14

# –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
formatted = context.format(100.5, "F2")  # "100.50"
formatted = context.format(100.5, "F3")  # "100.500"

# –°–≤–æ—ë —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
def format_num(value, decimals=3):
    rounded = round(value, decimals)
    formatted = str(rounded).rstrip('0').rstrip('.')
    if '.' not in formatted:
        formatted += '.'
    return formatted
```

---

## –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### –û—à–∏–±–∫–∞ 1: –ú–∞–∫—Ä–æ—Å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- G-–∫–æ–¥ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- –ù–µ—Ç –æ—à–∏–±–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª–∏

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –§–∞–π–ª –Ω–µ –≤ –ø–∞–ø–∫–µ `macros/python/`
2. –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `execute(context, command)`
3. –û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Python

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
macros/python/
‚îî‚îÄ‚îÄ your_macro.py  # –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–¥–µ—Å—å

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é
def execute(context, command):  # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è
    pass
```

---

### –û—à–∏–±–∫–∞ 2: IndexError –ø—Ä–∏ –¥–æ—Å—Ç—É–ø–µ –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º

**–°–∏–º–ø—Ç–æ–º—ã:**
```
IndexError: list index out of range
```

**–ü—Ä–∏—á–∏–Ω–∞:** –î–æ—Å—Ç—É–ø –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É —Å–ø–∏—Å–∫–∞

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
x = command.numeric[0]  # –û—à–∏–±–∫–∞ –µ—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –ø—É—Å—Ç–æ–π
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
if command.numeric and len(command.numeric) > 0:
    x = command.numeric[0]
else:
    x = context.registers.x  # –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ —Å default:
```python
x = command.getNumeric(0, context.registers.x)
```

---

### –û—à–∏–±–∫–∞ 3: NoneType error

**–°–∏–º–ø—Ç–æ–º—ã:**
```
AttributeError: 'NoneType' object has no attribute...
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–≤–æ–π—Å—Ç–≤—É None

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
for word in command.minorWords:  # minorWords –º–æ–∂–µ—Ç –±—ã—Ç—å None
    if word.upper() == "ON":
        ...
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
```python
if command.minorWords:  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ None
    for word in command.minorWords:
        if word.upper() == "ON":
            ...
```

---

### –û—à–∏–±–∫–∞ 4: –ù–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä—ã

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏
- –°–ª–µ–¥—É—é—â–∏–µ –º–∞–∫—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
x = command.numeric[0]
y = command.numeric[1]
z = command.numeric[2]

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
context.registers.x = x
context.registers.y = y
context.registers.z = z
```

---

### –û—à–∏–±–∫–∞ 5: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ G-–∫–æ–¥–∞

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑

**–ü—Ä–∏—á–∏–Ω–∞:** –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ:**
```python
# –î–ª—è –ø–æ–¥–∞—á–∏
last_feed = context.globalVars.GetDouble("LAST_FEED", 0.0)
if last_feed == feed:
    return  # –ù–µ –≤—ã–≤–æ–¥–∏–º

context.globalVars.SetDouble("LAST_FEED", feed)
context.write(f"F{feed:.1f}")

# –î–ª—è —Ç–∏–ø–∞ –¥–≤–∏–∂–µ–Ω–∏—è
if context.system.MOTION == "LINEAR":
    # –£–∂–µ –ª–∏–Ω–µ–π–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ ‚Äî –Ω–µ –≤—ã–≤–æ–¥–∏–º G1
    pass
```

---

### –û—à–∏–±–∫–∞ 6: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è IJK‚ÜíABC

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ–≤–æ—Ä–æ—Ç–Ω—ã–µ –æ—Å–∏ –¥–≤–∏–≥–∞—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –°—Ç–∞–Ω–æ–∫ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏
2. –ù–µ —É—á—Ç–µ–Ω–∞ –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∞ —Å—Ç–∞–Ω–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:
```python
import math

def ijk_to_abc(i, j, k):
    a = math.degrees(math.atan2(j, k))
    b = math.degrees(math.atan2(i, math.sqrt(j*j + k*k)))
    
    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
    if a < 0:
        a += 360
    if b < 0:
        b += 360
    
    return round(a, 3), round(b, 3), 0.0
```

---

### –û—à–∏–±–∫–∞ 7: Python –Ω–µ –Ω–∞–π–¥–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Error: Python runtime not found
```

**–ü—Ä–∏—á–∏–Ω—ã:**
1. Python –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è (Python 3.13+)

**–†–µ—à–µ–Ω–∏–µ:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python 3.8-3.12
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π Python runtime

---

## –°–æ–≤–µ—Ç—ã –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞–ª–∏—á–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

```python
# –ü–ª–æ—Ö–æ
x = command.numeric[0]

# –•–æ—Ä–æ—à–æ
if command.numeric and len(command.numeric) > 0:
    x = command.numeric[0]
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```python
x = command.getNumeric(0, context.registers.x)
name = command.getString(0, "DEFAULT")
```

### 3. –û–±–Ω–æ–≤–ª—è–π—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã

```python
context.registers.x = x
context.registers.y = y
context.registers.z = z
```

### 4. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

```python
if z < context.config.safety.retractPlane:
    context.warning(f"Z={z:.3f} –Ω–∏–∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –≤—ã—Å–æ—Ç—ã!")
    z = context.config.safety.retractPlane
```

### 5. –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –∫–æ–¥

```python
# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è IJK –≤ ABC –¥–ª—è 5-–æ—Å–∏
# –ò—Å–ø–æ–ª—å–∑—É–µ–º atan2 –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞
a = math.degrees(math.atan2(j, k))
```

### 6. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ –ø—Ä–æ—Å—Ç—ã—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö

```
# –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç–æ–≤—ã–π APT
PARTNO/TEST
GOTO/0, 0, 0
GOTO/100, 50, 10
SPINDL/ON, CLW, 1600
FEDRAT/500
FINI
```

### 7. –í–µ–¥–∏—Ç–µ –∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π

```python
# -*- coding: ascii -*-
# GOTO MACRO - Linear Motion
# Version: 1.2
# Changes:
#   1.2 - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 5-–æ—Å–∏
#   1.1 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥–∞—á–∏
#   1.0 - –ù–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [ARCHITECTURE.md](ARCHITECTURE.md) ‚Äî –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ—Å—Ç–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
- [CUSTOMIZATION_GUIDE.md](CUSTOMIZATION_GUIDE.md) ‚Äî –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- [QUICKSTART.md](QUICKSTART.md) ‚Äî –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤
